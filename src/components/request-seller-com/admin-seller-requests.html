<div class="fab-wrapper">
  <button class="fab-main" (click)="togglePopup()">
    <i class="fas fa-book"></i>
  </button>
</div>

<!-- Popup -->
<div class="popup-backdrop" *ngIf="isOpen">
  <div class="popup">
    <h2>Qu·∫£n l√Ω Admin</h2>

    <!-- Tabs -->
    <div class="tabs">
      <button [class.active]="activeTab==='seller'" (click)="activeTab='seller'">Seller Requests</button>
      <button [class.active]="activeTab==='product'" (click)="activeTab='product'">Products Pending</button>
    </div>

    <!-- Seller Requests -->
    <div *ngIf="activeTab==='seller'">
      <ul *ngIf="!selectedRequest && requests.length > 0">
        <li *ngFor="let req of requests" (click)="selectRequest(req)">
          üìß {{ req.email }}
        </li>
      </ul>
      <p *ngIf="!selectedRequest && requests.length === 0">Kh√¥ng c√≥ y√™u c·∫ßu n√†o ƒëang ch·ªù x·ª≠ l√Ω.</p>

      <div *ngIf="selectedRequest">
        <p><b>H·ªç t√™n:</b> {{ selectedRequest.fullName }}</p>
        <p><b>SƒêT:</b> {{ selectedRequest.phone }}</p>
        <p><b>ƒê·ªãa ch·ªâ:</b> {{ selectedRequest.address }}</p>
        <p><b>Email:</b> {{ selectedRequest.email }}</p>
        <p><b>Ng√¢n h√†ng:</b> {{ selectedRequest.bankAccount }}</p>

        <div class="thumbs">
          <div class="thumb-item" (click)="previewImage(selectedRequest.cccdFrontUrl)">
            <img [src]="selectedRequest.cccdFrontUrl" />
            <p>M·∫∑t tr∆∞·ªõc</p>
          </div>
          <div class="thumb-item" (click)="previewImage(selectedRequest.cccdBackUrl)">
            <img [src]="selectedRequest.cccdBackUrl" />
            <p>M·∫∑t sau</p>
          </div>
        </div>

        <div class="actions">
          <button (click)="approveSeller(selectedRequest)">‚úÖ Ch·∫•p nh·∫≠n</button>
          <button (click)="rejectSeller(selectedRequest)">‚ùå T·ª´ ch·ªëi</button>
          <button (click)="selectedRequest=null">‚¨Ö Quay l·∫°i</button>
        </div>
      </div>
    </div>

    <!-- Products -->
    <div *ngIf="activeTab==='product'">
      <ul *ngIf="!selectedProduct && products.length > 0">
        <li *ngFor="let prod of products" (click)="selectProduct(prod)">
          üì¶ {{ prod.productName }} - {{ prod.brand }} - {{ prod.price | number }}
        </li>
      </ul>
      <p *ngIf="!selectedProduct && products.length === 0">Kh√¥ng c√≥ s·∫£n ph·∫©m pending.</p>

      <div *ngIf="selectedProduct">
        <p><b>Ng∆∞·ªùi ƒëƒÉng:</b> {{ selectedProduct.ownerEmail }}</p>
        <p><b>T√™n:</b> {{ selectedProduct.productName }}</p>
        <p><b>M√¥ t·∫£:</b> {{ selectedProduct.description }}</p>
        <p><b>Gi√°:</b> {{ selectedProduct.price | number }}ƒë</p>
        <p><b>Size:</b> {{ selectedProduct.size }}</p>
        <p><b>S·ªë l∆∞·ª£ng:</b> {{ selectedProduct.quantity }}</p>
        <p><b>Th∆∞∆°ng hi·ªáu:</b> {{ selectedProduct.brand }}</p>
        <p><b>Gi·∫£m gi√°:</b> {{ selectedProduct.discount }}%</p>
        <p><b>Rating:</b> {{ selectedProduct.productRating }}</p>

        <div class="thumbs">
          <div class="thumb-item" *ngFor="let img of selectedProduct.productImage" (click)="previewImage(img)">
            <img [src]="img" />
          </div>
        </div>

        <div class="actions">
          <button (click)="approveProduct(selectedProduct)">‚úÖ Duy·ªát</button>
          <button (click)="rejectProduct(selectedProduct)">‚ùå T·ª´ ch·ªëi</button>
          <button (click)="selectedProduct=null">‚¨Ö Quay l·∫°i</button>
        </div>
      </div>
    </div>

    <div class="actions" *ngIf="!selectedRequest && !selectedProduct">
      <button (click)="togglePopup()">ƒê√≥ng</button>
    </div>
  </div>
</div>

<!-- Modal preview ·∫£nh l·ªõn -->
<div class="preview-backdrop" *ngIf="previewUrl" (click)="closePreview()">
  <img [src]="previewUrl" class="preview-large" />
</div>
